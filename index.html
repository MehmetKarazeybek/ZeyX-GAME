<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Geometry Dash Klonu</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            background: linear-gradient(135deg, #1a0033, #330066);
            color: #fff;
            font-family: 'Arial', sans-serif;
            overflow: hidden;
            height: 100vh;
            position: relative;
        }
        canvas {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
            z-index: 3;
        }
        #home, #shop {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 2;
            text-align: center;
            background: rgba(0, 0, 0, 0.8);
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #00ffcc;
            width: 90%;
            max-width: 400px;
        }
        #home::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: repeating-linear-gradient(
                45deg,
                rgba(255, 255, 255, 0.05),
                rgba(255, 255, 255, 0.05) 10px,
                transparent 10px,
                transparent 20px
            );
            pointer-events: none;
        }
        #cubePreview {
            width: 60px;
            height: 60px;
            margin: 15px auto;
            animation: rotatePreview 8s linear infinite;
        }
        @keyframes rotatePreview {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        button {
            display: block;
            width: 100%;
            max-width: 200px;
            padding: 12px;
            margin: 10px auto;
            background: linear-gradient(180deg, #00ffcc, #00b3b3);
            color: #000;
            border: 2px solid #00ffcc;
            border-radius: 5px;
            cursor: pointer;
            font-size: 18px;
            font-weight: bold;
            text-shadow: 1px 1px 1px rgba(0, 0, 0, 0.5);
            transition: all 0.2s;
            box-shadow: 0 0 10px rgba(0, 255, 255, 0.5);
        }
        button:hover {
            background: linear-gradient(180deg, #00e6b8, #009999);
            border-color: #00e6b8;
            transform: translateY(-2px);
            box-shadow: 0 0 15px rgba(0, 255, 255, 0.8);
        }
        #shopItems {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 15px;
            justify-items: center;
            padding: 10px;
        }
        .shop-item {
            text-align: center;
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            padding: 10px;
            border-radius: 10px;
            border: 3px solid #00b7eb;
            box-shadow: 0 0 10px rgba(0, 183, 235, 0.5);
            width: 100px;
            height: 150px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: center;
        }
        .shop-item canvas {
            display: block;
            margin: 0 auto;
            border-radius: 5px;
            width: 50px;
            height: 50px;
        }
        .shop-item .quantity {
            color: #ffd700;
            font-size: 14px;
            font-weight: bold;
            text-shadow: 1px 1px 1px #000;
        }
        .shop-item .price {
            display: flex;
            align-items: center;
            color: #00ffcc;
            font-size: 14px;
            font-weight: bold;
            text-shadow: 1px 1px 1px #000;
        }
        .shop-item .price::before {
            content: '★';
            margin-right: 5px;
            color: #ffd700;
        }
        .shop-item button {
            width: 80px;
            padding: 6px;
            font-size: 14px;
            margin: 0;
        }
        h1 {
            font-size: 36px;
            color: #00ffcc;
            text-shadow: 0 0 10px #00ffcc, 0 0 20px #00ffcc;
            margin: 15px 0;
            animation: glow 2s infinite alternate;
        }
        @keyframes glow {
            from { text-shadow: 0 0 10px #00ffcc, 0 0 20px #00ffcc; }
            to { text-shadow: 0 0 20px #00ffcc, 0 0 30px #00ffcc; }
        }
        h2, h3, p {
            color: #ddd;
            margin: 8px 0;
            text-shadow: 1px 1px 1px #000;
            font-size: 16px;
        }
        #background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            background: linear-gradient(135deg, #1a0033, #330066);
        }
        #background::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: repeating-linear-gradient(
                45deg,
                rgba(255, 255, 255, 0.05),
                rgba(255, 255, 255, 0.05) 10px,
                transparent 10px,
                transparent 20px
            );
            pointer-events: none;
        }
        #profileButton {
            position: fixed;
            bottom: 15px;
            right: 15px;
            width: 80px;
            padding: 8px;
            font-size: 14px;
            z-index: 2;
        }
        @media (max-width: 600px) {
            h1 { font-size: 28px; }
            h2, h3, p { font-size: 14px; }
            button { font-size: 16px; padding: 10px; }
            #cubePreview { width: 50px; height: 50px; }
            .shop-item { width: 90px; height: 140px; }
            .shop-item canvas { width: 45px; height: 45px; }
            .shop-item .quantity, .shop-item .price { font-size: 12px; }
            .shop-item button { font-size: 12px; width: 70px; padding: 5px; }
            #home, #shop { padding: 15px; }
        }
    </style>
</head>
<body>
    <div id="background"></div>
    <div id="home">
        <h1>Geometry Dash Klonu</h1>
        <h2>Skor: <span id="scoreDisplay">0</span> | Seviye: <span id="levelDisplay">1</span></h2>
        <button onclick="startGame()">Oyna</button>
        <button onclick="showShop()">Dükkan</button>
        <h3>Seçili Küp</h3>
        <canvas id="cubePreview" width="60" height="60"></canvas>
    </div>
    <div id="shop" style="display: none;">
        <h2>Dükkan</h2>
        <p>Skor: <span id="shopScoreDisplay">0</span></p>
        <div id="shopItems"></div>
        <button onclick="showHome()">Anasayfaya Dön</button>
    </div>
    <button id="profileButton">Profil</button>
    <canvas id="gameCanvas"></canvas>
    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const previewCanvas = document.getElementById('cubePreview');
        const previewCtx = previewCanvas.getContext('2d');
        const background = document.getElementById('background');

        // Mobil cihaz kontrolü
        const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);

        // Canvas'ı tam ekran yap
        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
        window.addEventListener('resize', resizeCanvas);
        resizeCanvas();

        // Oyuncu
        let player = {
            x: 100,
            y: window.innerHeight - 100,
            width: window.innerWidth < 600 ? 25 : 30,
            height: window.innerWidth < 600 ? 25 : 30,
            velocityY: 0,
            gravity: 0.7,
            jumpPower: -14,
            isJumping: false,
            doubleJump: false,
            rotation: 0,
            skin: 0
        };

        // Engeller, toplayıcılar
        let obstacles = [];
        let collectibles = [];
        let obstacleFrequency = 80;
        let baseSpeed = isMobile ? 4 : 6;
        let frameCount = 0;
        let score = 0;
        let level = 1;
        let difficulty = 1;
        let scoreMultiplier = 1;
        let gameActive = false;

        // Hareketli arka plan için parçacıklar
        let particles = [];
        for (let i = 0; i < 50; i++) {
            particles.push({
                x: Math.random() * canvas.width,
                y: Math.random() * canvas.height,
                size: Math.random() * 20 + 10,
                speedX: (Math.random() - 0.5) * 2,
                speedY: (Math.random() - 0.5) * 2,
                color: `hsl(${Math.random() * 360}, 100%, 50%)`,
                shape: Math.random() < 0.5 ? 'square' : 'triangle'
            });
        }

        // Parlayan yıldızlar
        let stars = [];
        for (let i = 0; i < 30; i++) {
            stars.push({
                x: Math.random() * canvas.width,
                y: Math.random() * canvas.height,
                size: Math.random() * 5 + 2,
                opacity: Math.random(),
                opacitySpeed: (Math.random() * 0.02 + 0.01) * (Math.random() < 0.5 ? 1 : -1)
            });
        }

        // Parlayan çizgiler
        let lines = [];
        for (let i = 0; i < 5; i++) {
            lines.push({
                x: Math.random() * canvas.width,
                y: Math.random() * canvas.height,
                length: Math.random() * 100 + 50,
                angle: Math.random() * Math.PI * 2,
                speed: (Math.random() * 0.5 + 0.2) * (Math.random() < 0.5 ? 1 : -1),
                color: `hsl(${Math.random() * 360}, 100%, 70%)`,
                opacity: Math.random() * 0.5 + 0.3
            });
        }

        // Arka plan renk değişimi
        let hue = 0;

        // Arka plan görseli (Senin değiştirebileceğin URL)
        const backgroundImage = {
            url: 'data:image/jpeg;base64,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', // Varsayılan çalışan bir arka plan görseli
            imgObj: null,
            loaded: false
        };
        if (backgroundImage.url) {
            backgroundImage.imgObj = new Image();
            backgroundImage.imgObj.crossOrigin = "Anonymous";
            backgroundImage.imgObj.src = backgroundImage.url;
            backgroundImage.imgObj.onload = () => {
                backgroundImage.loaded = true;
                console.log(`Arka plan görseli yüklendi: ${backgroundImage.url}`);
            };
            backgroundImage.imgObj.onerror = () => {
                console.error(`Arka plan görseli yüklenemedi: ${backgroundImage.url}`);
                backgroundImage.loaded = false;
            };
        }

        // Küp görünümleri (Çalışan Geometry Dash görselleri)
        const skins = [
            {
                name: 'Varsayılan',
                cost: 0,
                color: '#00ccff',
                image: 'data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAkGBxMTEhUTExMWFhUXGBgXGRgVGBcaGBcYFRgXFxcYFx0YHSggGholHRcYITEiJSkrLi4uFx8zODMtNygtLisBCgoKDg0OGhAQGi0lHSYtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLf/AABEIAJoBSAMBIgACEQEDEQH/xAAaAAACAwEBAAAAAAAAAAAAAAADBAECBQAG/8QAMRAAAQMDAgQEBgIDAQEAAAAAAQACEQMhMQRBElFhcYGRsfATIqHB0eEF8RQyQnIj/8QAGgEAAwEBAQEAAAAAAAAAAAAAAQIDBAAFBv/EACURAAICAgIBBAMBAQAAAAAAAAABAhEDIRIxQQQTIlEUMmGBcf/aAAwDAQACEQMRAD8A8YxpGRlMUGGegEnwRG6oRwnw+6G/4gkWgxjl06LznbPuKSBOrEunH6R2OG+UqWEEgza0HZEYuaEimaAqC0Jo1x/yOVpk2WbRbe6bWeUUao2zR0FTn1T7q4GyyaVsX80y2vMcYjxlZZwthkvs2tO7cYQq+rPFAGFnU6hBsfl97Kuq1w4pvywbkJFj2ZXH5War3AuzYjAP0QXQOgNhPuyzKmvm4nug/wCaXeG528EyxMR0jadRvMyPcpiBw5ExMrI0+ptZ0gbnsmnVflO/K+EHBk2hgV+FuDBnnmf0gsrShNr/ACxEeKiiTxD6ckyiJRpU6bTd2BFhaehI9UlRYXO2AB54H3Wv/GMabOIur19E0TAgTjqfugpUKn8qK6fTEmAcj2FoHTcDYOfBJ0jwz9/fuVWprCP+vqhTYXGUnroC6mSZNvp7KE+IsjPrh1zJjyVG8PwyZPHNhFo+yskaI2uwLnQO/ooFOd1FKjxTe/XGFdroF4kWMFVSLKW6QP4p428QJA7nOw/CFTJ4rZOyv8SbhUoViH8QFx9wqqI7jp/8GNYwZJx78Vj1dWZ6StLWsJkzAsPmSFXRNy15ncR6KuNaDipLZSoxzmYgnn/XVY2pmY5LR/k/5AtlnAQdzMmPfqsKvWWnHBhlkpFatS2VWi610GrVn3ddRfe3uVqUdGb3fkHe/pHvN0MkckYDn9VXgv0TJDSkyOIj6fr7rT0LfitJ/wChfvbCzajEbQgiYsTa1jG/gn4ixk1Kn0GqNEkQY33jb1VadDi/1H17JhgAcASCI9dvO/JPUH0/9I84E/lMtB4psxjUsrNacck1qdGQTaRsRjyS9J8ECPG6rEyZLT2aNNtr+/JQrUSLX7rkw9nj2VfJN0q5IwSAPJZeUwwLypQVAhkY3V1BHrcGQq0NQd7pHUVtkWkleNcTlkbn2alPUcky2oUjTMBGpV+SzSgboS+2atKrbKpqnEpVjpT7aXyiTMLM48WXrkhag9zTv5+KL8QnIVXOgmFRrl1Xsg40XcBnHZJaipe30TbqE3iU1/HaAOfwxzvysUU1FWyE4tium1MhoMBo5zB7xda2mdObHM4Nx+vqup/w7WmSeI+n19wjNruYeFthmZnxAG9lKTUv1EUH5HnaA8Eu+UCJ5za3RU07WgwL9/DY2ST9eXWJttnzTeg4c/3f0ScGlsaMDS09MrY0bfiDhOR2n0WXpNW0GER+pLDbz5qfFshkhKWq34Hq2kEbg9Q48XiN1laimxpvf92NloVNUXNiVl1zKpCJ2CEupMX+H81sbI4ZsqUQe0IrHGeHnvYfUq/E1SdaLzGG293SuorgOLfqtGjTHI7dfRHr/wASwtvId4AfW8popJkHmjB7PMP1Nvl3Q6DyCSOyfOhaDEz05Dqg1acdCtCSN8MkZdCmse53h3WYZaQbyMLQ11cCJWe/UtOIvz2CvCLHdJFtbqOPhByEjqaQ98+iJwNn/e05iOeb5wurUCW8TCS33HgrxjRJu10Z1bTgNJvty8UAOjCcrUnReyQc0iy0RRgzPi9IIap6ff1RrkTHkUGlTlP6emIynoWDcuwLDOQj0zf8qXM4ThEqNNiEyQ9tEEgxbH1/aq1vM2VjVGDn0SuorwU6iRyZUtm1pdS0tLXc7H+1za1KC03yW4ybRIusN2pMT0UN1JF7JlAhP1i6PSU6I4Q6RftnspWLS1JiSb+/Fcn4g/KieaBUOeqAkrnOHJebxKOWivEisfGClnuko1ISmcRIy3ocpaiyapOICUo0wnqcdVmmkehi5PsJRfzWjSqE4WXLd9vVN6V7tsXWfJC9mzFKnQ8GEhQ3TTIRGPsi0XHCzNNGlwTBMDhYwR1np4rQp6s0x/qC3psevPulahKltT5SD793SON9kXjS6Gf8ziEWE37pB7rm1vv0VKboMRbqiOOydQromlZLa5FxlaFDU8W9znv0WWVek+CPeUzhZ3HdmsyoQZyjt1UrObU5XVXOIKChY1G6yvO/1hQKohZjX/Lm/wBUbTagRBAPInIRWMVwroefWj9dUbT1A8yR+PFLaOuwQHt4oMi5joq1tWRj5RsBaB3VFAm4OTpL/TQ1UNI+f5umANhPNdS/lCIDiT13CxC8lS2pFzc8unmqLHod+mXH5bHNYz5pEkGTM2PZIVHRzg4/aYd/JDhuLeKza1YG4P6VYQYcUHHsV1TC4yVSrSGd1c1NjbkitpEjC0KJopMyqjuL5du10xRpwbSe9lNfTWMZTOj07o8MqtGdRfLYOpQGMjPZZ1XStBK167OEE7zZZlR5cU8UQ9Q4+examzh68lFR95COKZOyg0ZVUjDK6pBaD+JpnKimTPDeESnoHCLSCO+U6dMAAZnpGEyGXJrZhamkSTlDhtputeu0TcTCCGtm7QOn3sqIwZY03sFpaLXNJJi0D1ugVNNNwralo/5CJpHPa64iOadIyzmn8Wv9BhkCB5rlpuZzjmoTCSijxLXqrnKjygyvOUTdLJWhkK4MJUORGFc0dGZo0tRCYo6u9xb0We1w5I9NsxCjKCN2PLLwzTfwu38k3pTDc/tInTBrZR9HUyCf12WeUbR6MG1LfY3T1AwmagcACFivIabFMUtc53yz9ApyxeUUjnX6vsfbqrKzK8pB1LkZhXpEghL7aB7jumPNCIDJhLtqAorXCeqXgMM1aECy5lJpAyCjn/TnMbRHbmEOk8IqI1WdRpObMiwujsbe6j45wFDTe1uibgdxosKZEwpoMkq7yA3KDSqEEjfonUAsZ4yMhV1LjFroNWqRnv8ArortJi6eMDkimmqk7QjOk4RKFJvOFd1PsVRRDfhieooyOHCt/it4YaLQJn7Ij6RJtCs2Ygj8FUSA6tMzW0CDj9DdOaZo/wBeSIygZhGYwBUSOuugP+OD3VjTMWXOqQYgqra/GDwXAt4p6FlNdGdUpEuPIkH+grVtI09O3qmalMwZH57KlImbJjHKtpif+MR2NkeloHGMT4Jim0E35zdbFMNsA7ueRRsjSMt9ItaCRZDpaVzrg+Ce/kRF7AbDtvfsUp8VzWm0J4k5zXkU1GiLeo5rN1FHz9FqjUE2P5xsUKu5vC6bHrmFaKPNzSi1oxn0DAvm9r+iUp6ojOEeq5wNj5fjZBNK8u3uffNWUTyMmTeh2hUmxUqoIi1hjwXJ6FeWjyAq2I558LoRV3t5fRQGleWetJtncCsKas1TKA6iglPqm6doiPBJMKNTMXIskaNOOdGu2vIgpStWIMfVCFYHGVRzzKmoUa8mfktF9O/idcxK09IxzDBw4j6YWZRpcRAFpWvUp/CAi578uSWf0P6eLrk/HkYbEkD+yubWvHglv8sbZ9N1FN4cTJg3M/0pcDS8i8DtBgm5HgjYS1FskQnSLyg1srDo0qFZpYG/9Wzur1NKG/MXDCo+i0MlsggT5iCs1+pJy5dGN9D3QSrVIPy4RQ4kTgz76penUnfH1QHvdxzj7KiiK51s0fiCb5hVFQAzJ5LPfUO6G9pzJ7/lOoCSy/w2HVQc7KwrAQFi0a5uBM7yfRE/y7jf3ZMoAXqVVm66oGiTZdW1bQLX7XQf47UB4hw88K1Sg2RwN3vHTlZMkNPI2riPU22knN/6m/mq1K1sWTOp0BF+LbuhupgC4ldVnKVoBRe4kQPJMClzsVU1uEWEdc+CS1Wp4QSD+06QHLj2V1laNpjr+ExpHc4FsBea1NdzyTj8LQ0LzAE+In1Kpx0Y16hOZ6OoGlhiJhYZ17QQIvzGyvVquAMG+D6SsbXUTJcAYPKenPKeMfsz+p9Q4/qa9CuCTlGpPIMi/ndZWirGBbzt62TWi1IB9beibiQXqE6PQCs1zfmaYH/QE45rL/laAAJY6YyA6THbIHdF138iOA4kiIxib/Vear1OspoQI+q9RFKio1ha6w8/VNN+eDjms97TZ03938oTVCwu4T0V0jx/dfTLVqRnKDWpyj1XdUJwVEZsmQX4D75LkVoXJjM2eLD7otzdUa2CmGsDsBeS2fSwi2Ac4yjWPTtsi/4375IvwQGiBHnf7IWXjiluxF5hWDkfUUxmItj1Soej2TknGVDujF0ZrOJ17DnlJ6eoQbGCnKNTn5qcka8MotJMboN4fmPJEbqeIyVnPrE2mwVqNSCl4GpZ0tLo1KEEy4gRfwVWlpt2SVSqDhSHTAQ4DPMujZpcIbMxHPfpKmhq4Mz9/VY/ERaVNErvbG/I2qR6VmtJbM4NvELOJLjO33QaD4nr+Vf4hJsPfJdGFFJZOSVjFO3dL13mbqG1S03+qpUfJTqJOeRVQdldSKiExsLjzTJC+462W4gDhCNSDNiofUuocJwmozzyfRufxpa8Gc8xYwPVa+neGAmOJuJ3E+ndebpN4QI3/S9B/E1PlI7ekJWjVilemNjXg/8AMd0jrNQeZVNQ4X726dEq5yZRHlkpUhnTP4jBJgpf+RAGci3K/VTRcAQV38gWOnI6lOlshPJ8TOAm8JqnXAAEID6LgJBsPBCYbqiR57y8WF1BcDlVGsMQccvyg16pJuSe6C9ydIyZM2w5Ii3PHvsUMaoiQCfc/lJViRjdVoO5p1Exzz70aQ1J4SNzm3ohDeV1BhsVFZ28bp0jPPK32Xa+L5i11Mc7dPwlXVjtlWFSwkp0ZZ5A7nSr0ilfjCbYRG1QUxnlMYcVyC58LkROZ5cUzyTNOGXIvshaerv/AGqaurJ/K8imz7WMowjyXZapqJ/CJR1pF8/tZvEZyih3LKLiiMfUSu7Gtc6TImPyk0yytIg/0r2NyPt6IrQZJZHdgGG6I6raFBA2F1BC4CbSogVTjZHY6yBworEKHg35CtR+KwS/xAFzK111FlNIK6Vdr4Vi8RhQIXUN57HtKC5pMgAdc2nEJvStJFy0Cd8/0shsZv6GUxQqHc2+6HEtjypNWaGoFzPmbpcDb0TGk4XfK4mdicT6q5ohsid/TP2QWtFZLl8kLB53CHWqFO8I4c2H39/RLVgIVEjPktLsR40zpqsOEhJvYUQSqUYPdadm2yoP9vRMt1oiBMDaLrH07uaKNSB0PvCHE0/laNN1URfv5q1NjjgA+IG07lKUNU14JuY3nFxPdF0uph3CI4ibTnnbbb6opCvOn5JYeZA85+gRaFRs3B849/RU1VNxuRBPceqUa84ITcSMszizT19VhbwxaZsfRYfxLx5JpyW1DJiALWt6908YmXPlcnYB7jOVdx2O4V2ULyiBidIxSmZtRpJjZGo6abps0BlWwnSM0pBKbOiFXjCv8fYeZj77qCbYTIhPIJNEHEqH0zE7c7o5aSoa83bkHZcZ3IUdTi6rp697pmq6MJZ7LyuBYy98hcgh1ly6xTy7XHYqKlQkqpcqOXnn0TnqgjHIspYFTxIgjkoZZV6witlIApylqDEG/KdkKLY8t9h9PUgnn6dkZzDExt7IQNOGk3nwT76RaGxMQc4FzPa6Vm3Erj/BRrVUujCsQJguA94Q6j428URXKivEi0RJhLcSNSMJqJwlsK5+0yEVtZJhyMDK6h1McDpR2pOg5GaV3Eosnk0WW6x72U/HEXv78ki2qeaYo0y4TI+65RH969INTqfpUqSVYQAhVHEpkiM562DcVUvUuuqOCokY5zLsqnZUe7mr0rXU1WcSZIlKTotSDSDch82t5z/SKQWw6b+kGD6JUUyMDH0RGnck3yjxJ8zXf/IQwAkl229rY6ZyEJmqkCW359FmmrIgY9FzanJFROlmbNRxXNS2nwmGpqJSyjOnpzNjibbRuein4IGTJn/m4jnOEFlUgb+fmi0NcBIc0Gdzcj8o0Z55NFnESSTF/WduSQ1ToOcqmvrOLiBB2sI95SDybImdybGONO6aoYh1xGPH6ftZtJjjeQEVlZzbCO6JGQ9qqgiGmEiKkGSpJlCe2FzERapWvzHXKqx1lzWIjqYhAINxXKA0yuXHWeWptldVjAUBxXFYT6DwVAXQu4lUlcTdIIGpl1EAA5JHkl2VO3kmA+09VxoxcWQ2yYqahw3z7hLGpJCI4SuLRdJ8WDLyuL1f4SoWoiNNHByK0oKn4i45SrsuSjU3ILXSiNaUQpjTSi0ylPiIrKqNDcxqVcVoSvxEam9NQOf0O6dhe4NnJXVGwSOvmgUHlpkJqo+TA2F++/4XUc5Jx/oqZlWcivpmJjcDxP8ARQXAqiM0mDlTUqREZ/u66oIVAJRIyZJruO6vKC8I1N8hMSbBOJCrTqFHdTld/jxdGhGx3Siyb4oskdMCAr1a0IkZSCvrJOvqr2KpX1CC0yULJM0mNLvm7g5ttKDqgGzF5P8ASEK0KtUjM81wti1WqeaPo9VAKUrER1QQ9Cw8bQ+a159+KuxxlLUaZdcc07RoOF8WzOc8sW2REaSG6YtKIxoJvgZhS2g6mwPdAGwJufDks92p+Yx4QjZOht0beH7XIbavCOOLbdSoXHUzxnEo4lUKVhPcsmVEqFYrgdnNR6WIQWorFxXGTwpmiYuqsGEWp9lxqhGtkioLoBddcqoo6UmyKiAjPQiuM+TslpT+lqjB81nBP6Zo4GmP+iPoEQ4m7D1dPuCgF0I9YY7JRMhpvYZlRXFVKIlJMS5M1KFS1yn9PUABJEhwjNwQe2PeyyqSPTPyo0Pzo3f5drIFRmHC4IghwzGxBWfwE4Av1sOl1DD/APN3Zv3XU/8AQ+KK6J5JW7BmkXYVRSIzZH05/wBv/P3CpU+ycg3qyDSlWp0REz0ge+66hke9kes0cGN0SbYu5p5GFCs5xjPJUOEUTbLtdZCqOVJwi1MriMhSqCqUnkJyoLBJP397pRSXu3lWBQGlEauAUqFUaFz8qUBhjS1CDIMHojOq7gkEY7xe/W6SYucUbFrY4NS95vJ55PcmVNOqGOIcJFwQD5Y6wUjKNS38FwKHdZrAWgCOEWA3B53XLP1Iue65GwqJ/9k=', // Varsayılan küp
                unlocked: true,
                imgObj: null,
                loaded: false,
                quantity: '3/3'
            },
            {
                name: 'Yıldız',
                cost: 100,
                color: '#ffd700',
                image: 'https://static.wikia.nocookie.net/geometry-dash/images/5/5a/Icon002.png', // Yıldızlı küp
                unlocked: false,
                imgObj: null,
                loaded: false,
                quantity: '2/3'
            },
            {
                name: 'Alev',
                cost: 200,
                color: '#ff4500',
                image: 'https://static.wikia.nocookie.net/geometry-dash/images/6/62/Icon003.png', // Alevli küp
                unlocked: false,
                imgObj: null,
                loaded: false,
                quantity: '1/3'
            },
            {
                name: 'Buz',
                cost: 150,
                color: '#00b7eb',
                image: 'https://static.wikia.nocookie.net/geometry-dash/images/9/9b/Icon004.png', // Buzlu küp
                unlocked: false,
                imgObj: null,
                loaded: false,
                quantity: '2/3'
            },
            {
                name: 'Limon',
                cost: 250,
                color: '#32cd32',
                image: 'https://static.wikia.nocookie.net/geometry-dash/images/0/0e/Icon005.png', // Limon küp
                unlocked: false,
                imgObj: null,
                loaded: false,
                quantity: '1/3'
            },
            {
                name: 'Galaksi',
                cost: 300,
                color: '#8a2be2',
                image: 'https://static.wikia.nocookie.net/geometry-dash/images/1/1d/Icon006.png', // Galaksi küp
                unlocked: false,
                imgObj: null,
                loaded: false,
                quantity: '1/3'
            }
        ];

        // Görselleri yükle ve yükleme durumunu takip et
        skins.forEach(skin => {
            if (skin.image) {
                skin.imgObj = new Image();
                skin.imgObj.crossOrigin = "Anonymous"; // CORS için
                skin.imgObj.src = skin.image;
                skin.imgObj.onload = () => {
                    skin.loaded = true;
                    console.log(`Görsel yüklendi: ${skin.image}`);
                    updateShop();
                    updatePreview();
                };
                skin.imgObj.onerror = () => {
                    console.error(`Görsel yüklenemedi: ${skin.image}`);
                    skin.loaded = false;
                    updateShop();
                    updatePreview();
                };
            } else {
                skin.loaded = false;
            }
        });

        // Oyun döngüsü
        function gameLoop() {
            if (!gameActive) return;
            update();
            draw();
            requestAnimationFrame(gameLoop);
        }

        function update() {
            // Oyuncu
            player.velocityY += player.gravity;
            player.y += player.velocityY;
            player.rotation += 0.1;

            // Yer çarpma
            if (player.y + player.height > canvas.height - 20) {
                player.y = canvas.height - 20 - player.height;
                player.velocityY = 0;
                player.isJumping = false;
                player.doubleJump = false;
            }
            if (player.y < 20) {
                player.y = 20;
                player.velocityY = 0;
            }

            // Zorluk
            difficulty = 1 + score / 1000;
            let currentSpeed = baseSpeed * difficulty;
            let currentFrequency = Math.max(50, obstacleFrequency / difficulty);

            // Engeller
            frameCount++;
            if (frameCount % Math.floor(currentFrequency) === 0) {
                let type = Math.random();
                let obstacle;
                if (type < 0.4) {
                    obstacle = {
                        x: canvas.width,
                        y: canvas.height - 40 - 20,
                        width: 30,
                        height: 40,
                        type: 'spike',
                        passed: false
                    };
                } else if (type < 0.6) {
                    obstacle = {
                        x: canvas.width,
                        y: canvas.height - 60 - 20,
                        radius: 20,
                        type: 'saw',
                        rotation: 0,
                        passed: false
                    };
                } else if (type < 0.8) {
                    obstacle = {
                        x: canvas.width,
                        y: canvas.height - 80 - 20,
                        width: 60,
                        height: 20,
                        type: 'platform',
                        velocityY: 2 * difficulty,
                        passed: false
                    };
                } else {
                    obstacle = {
                        x: canvas.width,
                        y: canvas.height - 100,
                        width: 50,
                        height: 30,
                        type: 'spikeChain',
                        velocityY: 3 * difficulty,
                        passed: false
                    };
                }
                obstacles.push(obstacle);

                // Toplayıcılar
                if (Math.random() < 0.3) {
                    let colType = Math.random();
                    collectibles.push({
                        x: canvas.width + 50,
                        y: canvas.height - 100,
                        radius: 10,
                        type: colType < 0.5 ? 'multiplier' : 'doubleJump',
                        value: colType < 0.5 ? 2 : true
                    });
                }
            }

            // Engeller
            for (let i = obstacles.length - 1; i >= 0; i--) {
                let obs = obstacles[i];
                obs.x -= currentSpeed;

                if (obs.type === 'saw') {
                    obs.rotation += 0.2 * difficulty;
                }
                if (obs.type === 'platform') {
                    obs.y += obs.velocityY;
                    if (obs.y < canvas.height - 120 || obs.y > canvas.height - 60) {
                        obs.velocityY *= -1;
                    }
                }
                if (obs.type === 'spikeChain') {
                    obs.y += obs.velocityY;
                    if (obs.y < canvas.height - 150 || obs.y > canvas.height - 50) {
                        obs.velocityY *= -1;
                    }
                }

                // Çarpışma kontrolü
                let hit = false;
                if (obs.type === 'saw') {
                    let dx = player.x + player.width / 2 - (obs.x + obs.radius);
                    let dy = player.y + player.height / 2 - (obs.y + obs.radius);
                    if (Math.sqrt(dx * dx + dy * dy) < obs.radius + player.width / 2) {
                        hit = true;
                    }
                } else if (obs.type === 'spike' || obs.type === 'spikeChain') {
                    if (
                        player.x < obs.x + obs.width &&
                        player.x + player.width > obs.x &&
                        player.y < obs.y + obs.height &&
                        player.y + player.height > obs.y
                    ) {
                        hit = true;
                    }
                } else if (obs.type === 'platform') {
                    if (
                        player.x < obs.x + obs.width &&
                        player.x + player.width > obs.x &&
                        player.y < obs.y + obs.height &&
                        player.y + player.height > obs.y
                    ) {
                        if (player.velocityY > 0 && player.y + player.height - obs.y <= 5) {
                            player.y = obs.y - player.height;
                            player.velocityY = 0;
                            player.isJumping = false;
                            player.doubleJump = false;
                        } else {
                            hit = true;
                        }
                    }
                }

                if (hit) {
                    gameActive = false;
                    canvas.style.display = 'none';
                    background.style.display = 'block';
                    document.getElementById('home').style.display = 'block';
                    document.getElementById('scoreDisplay').textContent = score;
                    document.getElementById('shopScoreDisplay').textContent = score;
                    obstacles = [];
                    collectibles = [];
                    updateShop();
                    alert('Oyun Bitti! Skor: ' + score + ' | Seviye: ' + level);
                    return;
                }

                // Skor
                if (!obs.passed && player.x > obs.x + (obs.width || obs.radius * 2)) {
                    obs.passed = true;
                    score += Math.floor(10 * difficulty * scoreMultiplier);
                    document.getElementById('scoreDisplay').textContent = score;
                }

                // Ekran dışı
                if (obs.x + (obs.width || obs.radius * 2) < 0) {
                    obstacles.splice(i, 1);
                }
            }

            // Toplayıcılar
            for (let i = collectibles.length - 1; i >= 0; i--) {
                let col = collectibles[i];
                col.x -= currentSpeed;

                if (
                    player.x < col.x + col.radius * 2 &&
                    player.x + player.width > col.x &&
                    player.y < col.y + col.radius * 2 &&
                    player.y + player.height > col.y
                ) {
                    if (col.type === 'multiplier') {
                        scoreMultiplier = col.value;
                        setTimeout(() => { scoreMultiplier = 1; }, 5000);
                    } else if (col.type === 'doubleJump') {
                        player.doubleJump = true;
                        setTimeout(() => { player.doubleJump = false; }, 10000);
                    }
                    collectibles.splice(i, 1);
                }

                if (col.x + col.radius * 2 < 0) {
                    collectibles.splice(i, 1);
                }
            }

            // Hareketli arka plan parçacıkları
            particles.forEach(p => {
                p.x += p.speedX;
                p.y += p.speedY;
                if (p.x < 0 || p.x > canvas.width) p.speedX *= -1;
                if (p.y < 0 || p.y > canvas.height) p.speedY *= -1;
            });

            // Yıldızlar
            stars.forEach(s => {
                s.opacity += s.opacitySpeed;
                if (s.opacity > 1 || s.opacity < 0) s.opacitySpeed *= -1;
            });

            // Parlayan çizgiler
            lines.forEach(l => {
                l.x += Math.cos(l.angle) * l.speed;
                l.y += Math.sin(l.angle) * l.speed;
                if (l.x < -l.length || l.x > canvas.width + l.length || l.y < -l.length || l.y > canvas.height + l.length) {
                    l.x = Math.random() * canvas.width;
                    l.y = Math.random() * canvas.height;
                    l.angle = Math.random() * Math.PI * 2;
                    l.color = `hsl(${Math.random() * 360}, 100%, 70%)`;
                }
            });

            // Arka plan renk değişimi
            hue = (hue + 2) % 360;
        }

        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Arka plan görseli
            if (backgroundImage.imgObj && backgroundImage.loaded && backgroundImage.imgObj.complete) {
                ctx.globalAlpha = 0.5;
                ctx.drawImage(backgroundImage.imgObj, 0, 0, canvas.width, canvas.height);
                ctx.globalAlpha = 1;
            } else {
                // Görsel yoksa gradyan
                let gradient = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);
                gradient.addColorStop(0, `hsl(${hue}, 80%, 15%)`);
                gradient.addColorStop(1, `hsl(${(hue + 180) % 360}, 80%, 15%)`);
                ctx.fillStyle = gradient;
                ctx.fillRect(0, 0, canvas.width, canvas.height);
            }

            // Grid efekti
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.1)';
            ctx.lineWidth = 1;
            for (let x = 0; x < canvas.width; x += 50) {
                ctx.beginPath();
                ctx.moveTo(x, 0);
                ctx.lineTo(x, canvas.height);
                ctx.stroke();
            }
            for (let y = 0; y < canvas.height; y += 50) {
                ctx.beginPath();
                ctx.moveTo(0, y);
                ctx.lineTo(canvas.width, y);
                ctx.stroke();
            }

            // Parlayan çizgiler
            lines.forEach(l => {
                ctx.strokeStyle = l.color;
                ctx.globalAlpha = l.opacity;
                ctx.lineWidth = 2;
                ctx.beginPath();
                ctx.moveTo(l.x, l.y);
                ctx.lineTo(l.x + Math.cos(l.angle) * l.length, l.y + Math.sin(l.angle) * l.length);
                ctx.stroke();
            });
            ctx.globalAlpha = 1;

            // Parçacıklar
            particles.forEach(p => {
                ctx.fillStyle = p.color;
                if (p.shape === 'square') {
                    ctx.fillRect(p.x - p.size / 2, p.y - p.size / 2, p.size, p.size);
                } else {
                    ctx.beginPath();
                    ctx.moveTo(p.x, p.y - p.size / 2);
                    ctx.lineTo(p.x - p.size / 2, p.y + p.size / 2);
                    ctx.lineTo(p.x + p.size / 2, p.y + p.size / 2);
                    ctx.closePath();
                    ctx.fill();
                }
            });

            // Yıldızlar
            stars.forEach(s => {
                ctx.fillStyle = `rgba(255, 255, 255, ${s.opacity})`;
                ctx.beginPath();
                ctx.moveTo(s.x, s.y - s.size);
                ctx.lineTo(s.x + s.size * 0.3, s.y - s.size * 0.3);
                ctx.lineTo(s.x + s.size, s.y);
                ctx.lineTo(s.x + s.size * 0.3, s.y + s.size * 0.3);
                ctx.lineTo(s.x, s.y + s.size);
                ctx.lineTo(s.x - s.size * 0.3, s.y + s.size * 0.3);
                ctx.lineTo(s.x - s.size, s.y);
                ctx.lineTo(s.x - s.size * 0.3, s.y - s.size * 0.3);
                ctx.closePath();
                ctx.fill();
            });

            // Zemin/tavan
            ctx.fillStyle = '#333';
            ctx.fillRect(0, canvas.height - 20, canvas.width, 20);
            ctx.fillRect(0, 0, canvas.width, 20);
            ctx.strokeStyle = '#555';
            ctx.lineWidth = 2;
            ctx.strokeRect(0, canvas.height - 20, canvas.width, 20);
            ctx.strokeRect(0, 0, canvas.width, 20);

            // Oyuncu
            ctx.save();
            ctx.translate(player.x + player.width / 2, player.y + player.height / 2);
            ctx.rotate(player.rotation);
            if (skins[player.skin].imgObj && skins[player.skin].loaded && skins[player.skin].imgObj.complete) {
                ctx.drawImage(skins[player.skin].imgObj, -player.width / 2, -player.height / 2, player.width, player.height);
            } else {
                ctx.fillStyle = skins[player.skin].color;
                ctx.fillRect(-player.width / 2, -player.height / 2, player.width, player.height);
                ctx.strokeStyle = '#fff';
                ctx.strokeRect(-player.width / 2, -player.height / 2, player.width, player.height);
            }
            ctx.restore();

            // Engeller
            obstacles.forEach(obs => {
                if (obs.type === 'spike') {
                    ctx.fillStyle = '#ff4444';
                    ctx.beginPath();
                    ctx.moveTo(obs.x, obs.y + obs.height);
                    ctx.lineTo(obs.x + obs.width / 2, obs.y);
                    ctx.lineTo(obs.x + obs.width, obs.y + obs.height);
                    ctx.closePath();
                    ctx.fill();
                    ctx.strokeStyle = '#fff';
                    ctx.lineWidth = 1;
                    ctx.stroke();
                } else if (obs.type === 'saw') {
                    ctx.save();
                    ctx.translate(obs.x + obs.radius, obs.y + obs.radius);
                    ctx.rotate(obs.rotation);
                    ctx.fillStyle = '#aaa';
                    ctx.beginPath();
                    ctx.arc(0, 0, obs.radius, 0, Math.PI * 2);
                    ctx.fill();
                    ctx.strokeStyle = '#fff';
                    ctx.lineWidth = 1;
                    ctx.stroke();
                    for (let i = 0; i < 8; i++) {
                        ctx.beginPath();
                        ctx.moveTo(0, obs.radius * 0.8);
                        ctx.lineTo(obs.radius * 0.2, obs.radius * 1.3);
                        ctx.lineTo(-obs.radius * 0.2, obs.radius * 1.3);
                        ctx.closePath();
                        ctx.fillStyle = '#ff6666';
                        ctx.fill();
                        ctx.rotate(Math.PI / 4);
                    }
                    ctx.restore();
                } else if (obs.type === 'platform') {
                    ctx.fillStyle = '#00ccff';
                    ctx.fillRect(obs.x, obs.y, obs.width, obs.height);
                    ctx.strokeStyle = '#fff';
                    ctx.lineWidth = 1;
                    ctx.strokeRect(obs.x, obs.y, obs.width, obs.height);
                } else if (obs.type === 'spikeChain') {
                    ctx.fillStyle = '#ff4444';
                    for (let i = 0; i < 3; i++) {
                        ctx.beginPath();
                        ctx.moveTo(obs.x + i * 15, obs.y + obs.height);
                        ctx.lineTo(obs.x + i * 15 + 7.5, obs.y);
                        ctx.lineTo(obs.x + i * 15 + 15, obs.y + obs.height);
                        ctx.closePath();
                        ctx.fill();
                        ctx.strokeStyle = '#fff';
                        ctx.stroke();
                    }
                }
            });

            // Toplayıcılar
            collectibles.forEach(col => {
                ctx.fillStyle = col.type === 'multiplier' ? '#ffd700' : '#800080';
                ctx.beginPath();
                ctx.arc(col.x + col.radius, col.y + col.radius, col.radius, 0, Math.PI * 2);
                ctx.fill();
                ctx.fillStyle = '#fff';
                ctx.font = '12px Arial';
                ctx.fillText(col.type === 'multiplier' ? '2x' : '2J', col.x + col.radius - 8, col.y + col.radius + 4);
            });

            // Skor ve seviye
            ctx.fillStyle = '#fff';
            ctx.font = '24px Arial';
            ctx.fillText('Skor: ' + score, 10, 30);
            ctx.fillText('Seviye: ' + level, 10, 60);
            if (scoreMultiplier > 1) {
                ctx.fillText('Çarpan: ' + scoreMultiplier + 'x', 10, 90);
            }
            if (player.doubleJump) {
                ctx.fillText('Çift Zıplama!', 10, 120);
            }
        }

        // Kontroller
        document.addEventListener('keydown', (e) => {
            if (e.code === 'Space' && gameActive) {
                if (!player.isJumping) {
                    player.velocityY = player.jumpPower;
                    player.isJumping = true;
                } else if (player.doubleJump) {
                    player.velocityY = player.jumpPower;
                    player.doubleJump = false;
                }
            }
        });

        // Mobil dokunmatik kontrol
        canvas.addEventListener('touchstart', (e) => {
            e.preventDefault();
            if (gameActive) {
                if (!player.isJumping) {
                    player.velocityY = player.jumpPower;
                    player.isJumping = true;
                } else if (player.doubleJump) {
                    player.velocityY = player.jumpPower;
                    player.doubleJump = false;
                }
            }
        });

        // Dükkan
        function updateShop() {
            const shopItems = document.getElementById('shopItems');
            shopItems.innerHTML = ''; // Önceki içeriği temizle
            skins.forEach((skin, index) => {
                const itemDiv = document.createElement('div');
                itemDiv.className = 'shop-item';

                // Küp görseli için canvas
                const itemCanvas = document.createElement('canvas');
                itemCanvas.width = window.innerWidth < 600 ? 45 : 50;
                itemCanvas.height = window.innerWidth < 600 ? 45 : 50;
                const itemCtx = itemCanvas.getContext('2d');

                // Görseli çiz
                if (skin.imgObj && skin.loaded && skin.imgObj.complete) {
                    itemCtx.clearRect(0, 0, itemCanvas.width, itemCanvas.height);
                    itemCtx.drawImage(skin.imgObj, 0, 0, itemCanvas.width, itemCanvas.height);
                } else {
                    itemCtx.fillStyle = skin.color;
                    itemCtx.fillRect(0, 0, itemCanvas.width, itemCanvas.height);
                    itemCtx.strokeStyle = '#fff';
                    itemCtx.strokeRect(0, 0, itemCanvas.width, itemCanvas.height);
                    itemCtx.fillStyle = '#fff';
                    itemCtx.font = '10px Arial';
                    itemCtx.fillText(skin.loaded === false ? 'Hata!' : 'Yükleniyor...', 2, 20);
                }

                // Miktar
                const quantityText = document.createElement('div');
                quantityText.className = 'quantity';
                quantityText.textContent = skin.quantity;

                // Fiyat
                const priceText = document.createElement('div');
                priceText.className = 'price';
                priceText.textContent = skin.cost;

                // Seç/Satın Al tuşu
                const itemButton = document.createElement('button');
                itemButton.textContent = skin.unlocked ? 'Seç' : 'Satın Al';
                itemButton.addEventListener('click', () => {
                    if (skin.unlocked) {
                        player.skin = index;
                        updatePreview();
                        alert(`${skin.name} seçildi!`);
                    } else if (score >= skin.cost) {
                        score -= skin.cost;
                        skin.unlocked = true;
                        player.skin = index;
                        document.getElementById('scoreDisplay').textContent = score;
                        document.getElementById('shopScoreDisplay').textContent = score;
                        updateShop();
                        updatePreview();
                        alert(`${skin.name} satın alındı! Kalan Skor: ${score}`);
                    } else {
                        alert(`Yeterli skorun yok! Gerekli: ${skin.cost}, Mevcut: ${score}`);
                    }
                });

                itemDiv.appendChild(itemCanvas);
                itemDiv.appendChild(quantityText);
                itemDiv.appendChild(priceText);
                itemDiv.appendChild(itemButton);
                shopItems.appendChild(itemDiv);
            });
        }

        // Önizleme
        function updatePreview() {
            previewCtx.clearRect(0, 0, previewCanvas.width, previewCanvas.height);
            if (skins[player.skin].imgObj && skins[player.skin].loaded && skins[player.skin].imgObj.complete) {
                previewCtx.drawImage(skins[player.skin].imgObj, 0, 0, previewCanvas.width, previewCanvas.height);
            } else {
                previewCtx.fillStyle = skins[player.skin].color;
                previewCtx.fillRect(0, 0, previewCanvas.width, previewCanvas.height);
                previewCtx.strokeStyle = '#fff';
                previewCtx.strokeRect(0, 0, previewCanvas.width, previewCanvas.height);
            }
        }

        // Sayfalar
        function showShop() {
            background.style.display = 'none';
            document.getElementById('home').style.display = 'none';
            document.getElementById('shop').style.display = 'block';
            document.getElementById('shopScoreDisplay').textContent = score;
            updateShop();
        }

        function showHome() {
            background.style.display = 'block';
            document.getElementById('shop').style.display = 'none';
            document.getElementById('home').style.display = 'block';
            document.getElementById('scoreDisplay').textContent = score;
            document.getElementById('levelDisplay').textContent = level;
        }

        // Oyun başlat
        function startGame() {
            gameActive = true;
            baseSpeed = isMobile ? 4 : 6;
            difficulty = 1;
            frameCount = 0;
            scoreMultiplier = 1;
            player.velocityY = 0;
            player.y = window.innerHeight - 100;
            player.isJumping = false;
            player.doubleJump = false;
            player.rotation = 0;
            obstacles = [];
            collectibles = [];

            canvas.style.display = 'block';
            background.style.display = 'none';
            document.getElementById('home').style.display = 'none';
            gameLoop();
        }

        // İlk yükleme
        updatePreview();
        document.getElementById('scoreDisplay').textContent = score;
        document.getElementById('levelDisplay').textContent = level;
        updateShop();

        // Profil butonu (şimdilik işlevsiz)
        document.getElementById('profileButton').onclick = () => {
            alert('Profil bölümü henüz işlevsel değil!');
        };
    </script>
</body>
</html>
